/var/spool/slurmd/job223027/slurm_script: 2: module: not found
/home/tamiroffen/AI_Project/project/utils.py:30: RuntimeWarning: overflow encountered in exp
  probs = np.exp(probs)
/home/tamiroffen/AI_Project/project/utils.py:31: RuntimeWarning: invalid value encountered in divide
  probs = probs / probs.sum() #makes a legal prob. dist.
/home/tamiroffen/AI_Project/project/utils.py:81: RuntimeWarning: invalid value encountered in divide
  probs /= probs.sum()  # normalize the probs
/home/tamiroffen/miniconda3/envs/CNN_Chess_Env/lib/python3.8/site-packages/numpy/core/_methods.py:49: RuntimeWarning: overflow encountered in reduce
  return umr_sum(a, axis, dtype, out, keepdims, initial, where)
/home/tamiroffen/AI_Project/project/utils.py:33: RuntimeWarning: invalid value encountered in divide
  probs = probs / probs.sum()
Started Hyperparamter Tuning the Complex Model
Using cuda to train
Loaded datasets
Tuning 3 models...

training model with batch size=2048, LR=0.1
avg loss for epoch 1 is 7.973400592803955
epoch 1 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.18786274310151715
piece accuracy: [p,r,n,b,q,k]: [0.6862068965517242, 0.225531914893617, 0.24626209322779244, 0.274468085106383, 0.1425, 0.4019501625135428]
overall piece accuracy: 0.3094850948509485
avg loss for epoch 2 is 1.4148063659667969
epoch 2 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2488641584562765
piece accuracy: [p,r,n,b,q,k]: [0.7359550561797753, 0.25906735751295334, 0.6387640449438202, 0.3225480283114257, 0.17424242424242425, 0.47392290249433106]
overall piece accuracy: 0.4553846153846154
avg loss for epoch 3 is 0.46448180079460144
epoch 3 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.22042057258677478
piece accuracy: [p,r,n,b,q,k]: [0.7803571428571429, 0.2982456140350877, 0.5759803921568627, 0.422244094488189, 0.2466281310211946, 0.5304948216340621]
overall piece accuracy: 0.48160919540229885
avg loss for epoch 4 is 0.3153364956378937
epoch 4 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.23897487947221518
piece accuracy: [p,r,n,b,q,k]: [0.7090163934426229, 0.2406311637080868, 0.3897306397306397, 0.26019184652278177, 0.1536050156739812, 0.5123456790123457]
overall piece accuracy: 0.3894669781269909
avg loss for epoch 5 is 0.2991558909416199
epoch 5 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2519764338587039
piece accuracy: [p,r,n,b,q,k]: [0.7423822714681441, 0.2943201376936317, 0.603988603988604, 0.3510971786833856, 0.2264808362369338, 0.5128660159716061]
overall piece accuracy: 0.4658273381294964
avg loss for epoch 6 is 0.2193928211927414
epoch 6 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.273932480345306
piece accuracy: [p,r,n,b,q,k]: [0.7899022801302932, 0.27288428324697755, 0.5471544715447154, 0.39037433155080214, 0.24076809453471196, 0.5108459869848156]
overall piece accuracy: 0.4616394672669293
avg loss for epoch 7 is 0.40252819657325745
epoch 7 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2678598823830222
piece accuracy: [p,r,n,b,q,k]: [0.826171875, 0.27391304347826084, 0.4826224328593997, 0.37013669821240797, 0.22686567164179106, 0.4994232987312572]
overall piece accuracy: 0.48109965635738833
avg loss for epoch 8 is 0.23420996963977814
epoch 8 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2907258064516129
piece accuracy: [p,r,n,b,q,k]: [0.8074534161490683, 0.28305400372439476, 0.5483178239083751, 0.44021325209444023, 0.28064992614475626, 0.546679499518768]
overall piece accuracy: 0.5034674063800277
avg loss for epoch 9 is 0.20069651305675507
epoch 9 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2912093495934959
piece accuracy: [p,r,n,b,q,k]: [0.7743142144638404, 0.31237322515212984, 0.5379796397807362, 0.44555984555984557, 0.22052704576976423, 0.5625546806649169]
overall piece accuracy: 0.49572500436224043
avg loss for epoch 10 is 0.1924581527709961
epoch 10 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2959675374080649
piece accuracy: [p,r,n,b,q,k]: [0.764018691588785, 0.2764505119453925, 0.6433378196500673, 0.40031645569620256, 0.25234741784037557, 0.5865463494667761]
overall piece accuracy: 0.4937446443873179

training model with batch size=2048, LR=0.001
avg loss for epoch 1 is 0.44131067395210266
epoch 1 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2357157278417121
piece accuracy: [p,r,n,b,q,k]: [0.8992805755395683, 0.3354330708661417, 0.6590909090909091, 0.3940594059405941, 0.2553191489361702, 0.5266731328806984]
overall piece accuracy: 0.46659528907922915
avg loss for epoch 2 is 0.2163311094045639
epoch 2 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2582517411930958
piece accuracy: [p,r,n,b,q,k]: [0.8084358523725835, 0.29434697855750486, 0.5866983372921615, 0.35599505562422745, 0.2789473684210526, 0.4866732477788746]
overall piece accuracy: 0.4686339652139926
avg loss for epoch 3 is 0.19458243250846863
epoch 3 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.3023043345853213
piece accuracy: [p,r,n,b,q,k]: [0.8358881875563571, 0.26881720430107525, 0.5107327905255367, 0.3562992125984252, 0.28, 0.5123456790123457]
overall piece accuracy: 0.48572867696440564
avg loss for epoch 4 is 0.18277911841869354
epoch 4 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.30072205837486016
piece accuracy: [p,r,n,b,q,k]: [0.8220338983050848, 0.2333931777378815, 0.4909090909090909, 0.37513171759747105, 0.26695842450765866, 0.5224820143884892]
overall piece accuracy: 0.47886371322286103
avg loss for epoch 5 is 0.17748281359672546
epoch 5 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.29850444624090544
piece accuracy: [p,r,n,b,q,k]: [0.8231017770597738, 0.2532588454376164, 0.49705449189985274, 0.38307873090481787, 0.2305084745762712, 0.5235803657362849]
overall piece accuracy: 0.4915368991198375
avg loss for epoch 6 is 0.1713232696056366
epoch 6 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.31507058763569645
piece accuracy: [p,r,n,b,q,k]: [0.810296191819464, 0.3079584775086505, 0.510188679245283, 0.41051660516605165, 0.2526564344746163, 0.5344086021505376]
overall piece accuracy: 0.5109996764801036
avg loss for epoch 7 is 0.16830207407474518
epoch 7 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.3204305422204255
piece accuracy: [p,r,n,b,q,k]: [0.8333333333333334, 0.3135464231354642, 0.526235741444867, 0.44813278008298757, 0.3056338028169014, 0.5874485596707819]
overall piece accuracy: 0.545812963255007
avg loss for epoch 8 is 0.16449593007564545
epoch 8 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.33007931665649787
piece accuracy: [p,r,n,b,q,k]: [0.8218298555377207, 0.2909090909090909, 0.5775169857936998, 0.37985309548793283, 0.26985854189336234, 0.5497716894977169]
overall piece accuracy: 0.5180221811460258
avg loss for epoch 9 is 0.16102398931980133
epoch 9 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.3351061135592362
piece accuracy: [p,r,n,b,q,k]: [0.8345428156748912, 0.32628398791540786, 0.5479535736102626, 0.455842997323818, 0.27262180974477956, 0.5460251046025104]
overall piece accuracy: 0.5337061668681983
avg loss for epoch 10 is 0.15745647251605988
epoch 10 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.3281733746130031
piece accuracy: [p,r,n,b,q,k]: [0.8430268918073797, 0.27948303715670436, 0.5111624326404927, 0.4586739327883742, 0.2688296639629201, 0.5573604060913706]
overall piece accuracy: 0.5368079183420971

training model with batch size=2048, LR=1e-05
avg loss for epoch 1 is 0.42976483702659607
epoch 1 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.163894523326572
piece accuracy: [p,r,n,b,q,k]: [0.7275242047026279, 0.22875816993464052, 0.40640809443507586, 0.38443396226415094, 0.23157894736842105, 0.49278579356270813]
overall piece accuracy: 0.46720297029702973
avg loss for epoch 2 is 0.29584068059921265
epoch 2 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.23494371245393508
piece accuracy: [p,r,n,b,q,k]: [0.7256478999106345, 0.24489795918367346, 0.32083792723263505, 0.3382949932341001, 0.22144112478031636, 0.4827586206896552]
overall piece accuracy: 0.4346798452943704
avg loss for epoch 3 is 0.2540741562843323
epoch 3 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.24994920763917106
piece accuracy: [p,r,n,b,q,k]: [0.7650844730490748, 0.23095823095823095, 0.35653235653235654, 0.36164736164736166, 0.23595505617977527, 0.5125858123569794]
overall piece accuracy: 0.45824019508230035
avg loss for epoch 4 is 0.23450550436973572
epoch 4 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.26307456588355466
piece accuracy: [p,r,n,b,q,k]: [0.7966942148760331, 0.29024943310657597, 0.3875802997858672, 0.3892013498312711, 0.2242503259452412, 0.4846153846153846]
overall piece accuracy: 0.4684527276257037
avg loss for epoch 5 is 0.22369299829006195
epoch 5 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.26480429933076455
piece accuracy: [p,r,n,b,q,k]: [0.7944760357432982, 0.26141078838174275, 0.33748584371460927, 0.3793103448275862, 0.22623345367027678, 0.4892008639308855]
overall piece accuracy: 0.4543365881677197
avg loss for epoch 6 is 0.21678593754768372
epoch 6 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2726207458732423
piece accuracy: [p,r,n,b,q,k]: [0.8357142857142857, 0.29446640316205536, 0.3815648445873526, 0.3755656108597285, 0.24814814814814815, 0.5010438413361169]
overall piece accuracy: 0.4804709400112129
avg loss for epoch 7 is 0.20875594019889832
epoch 7 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.27546882919412063
piece accuracy: [p,r,n,b,q,k]: [0.8118361153262519, 0.2757936507936508, 0.4035608308605341, 0.3721461187214612, 0.24704336399474375, 0.49326424870466323]
overall piece accuracy: 0.4796688132474701
avg loss for epoch 8 is 0.20365405082702637
epoch 8 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2914476344520825
piece accuracy: [p,r,n,b,q,k]: [0.8027522935779816, 0.30039525691699603, 0.3638113570741097, 0.37475149105367794, 0.267538644470868, 0.50187617260788]
overall piece accuracy: 0.47121054457162675
avg loss for epoch 9 is 0.20025303959846497
epoch 9 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.28675090069518444
piece accuracy: [p,r,n,b,q,k]: [0.8088119590873328, 0.3101391650099404, 0.4169124877089479, 0.4240246406570842, 0.24473067915690866, 0.5164728682170543]
overall piece accuracy: 0.4889400106175898
avg loss for epoch 10 is 0.19678442180156708
epoch 10 accuracy on valid set:
Testing piece accuracy of model, over 1 num of epochs
from accuracy: 0.2870275791624106
piece accuracy: [p,r,n,b,q,k]: [0.8146487294469357, 0.2815884476534296, 0.4176356589147287, 0.3799126637554585, 0.23264311814859928, 0.4807090719499479]
overall piece accuracy: 0.47633451957295375
Finished tuning 3 models!
